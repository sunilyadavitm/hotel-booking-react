{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\pc\\\\Downloads\\\\hotel-booking-react\\\\src\\\\component\\\\payment\\\\PaymentPage.jsx\",\n  _s = $RefreshSig$();\nimport { Elements } from \"@stripe/react-stripe-js\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { useState, useEffect } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport PaymentForm from \"./PaymentForm\";\nimport ApiService from \"../../service/ApiService\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PaymentPage = () => {\n  _s();\n  const {\n    bookingReference,\n    amount\n  } = useParams();\n  const [clientSecret, setClientSecret] = useState(null);\n  const [error, setError] = useState(null);\n  const [paymentStatus, setPaymentStatus] = useState(null);\n  const navigate = useNavigate();\n  useEffect(() => {\n    const fetchClientSecrete = async () => {\n      try {\n        const paymentData = {\n          bookingReference,\n          amount\n        };\n        console.log(\"BOOKING NO IS: \" + bookingReference);\n        console.log(\"Amount  IS: \" + amount);\n        const uniquePaymentSecreet = await ApiService.proceedForPayment(paymentData);\n        console.log(\"UNIQUE CLIENT SECRETE FROM fetchClientSecrete is: \" + uniquePaymentSecreet);\n        setClientSecret(uniquePaymentSecreet);\n      } catch (error) {\n        var _error$response, _error$response$data;\n        console.log(error);\n        setError(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message);\n      }\n    };\n    fetchClientSecrete();\n  }, [bookingReference, amount]);\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 16\n    }, this);\n  }\n\n  //initilize strip with public key\n\n  const stripePromise = loadStripe(\"pk_test_51QUUt8HB3OLSUETB41PkCNVZvXQdjyIJx4n7u9EHrMUH0j3R5VAJE76l1fnwQbC3OJlkPwQDIi0KwXGjdU1phB3s00ZJEZOlbv\");\n\n  //du tion to ipdate payment status for our booking in our backend databse\n  const handlePaymentStatus = async (paymentStatus, transactionId = \"\", failureReason = \"\") => {\n    try {\n      const paymentData = {\n        bookingReference,\n        amount,\n        transactionId,\n        success: paymentStatus === \"succeeded\",\n        failureReason\n      };\n      await ApiService.updateBookingPaymeent(paymentData);\n      console.log(\"Payment sataus weas updated\");\n    } catch (error) {\n      console.log(error.message);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"payment-page\",\n    children: [/*#__PURE__*/_jsxDEV(Elements, {\n      stripe: stripePromise,\n      options: clientSecret,\n      children: /*#__PURE__*/_jsxDEV(PaymentForm, {\n        clientSecrete: clientSecret,\n        amount: amount,\n        onPaymentSuccess: transactionId => {\n          setPaymentStatus(\"succeeded\");\n          handlePaymentStatus(\"succeeded\", transactionId);\n          navigate(`/payment-success/${bookingReference}`);\n        },\n        onPaymentError: error => {\n          setPaymentStatus(\"failed\");\n          handlePaymentStatus(\"failed\", \"\", error.message);\n          navigate(`/payment-failed/${bookingReference}`);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }, this), paymentStatus && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\"Payment Status: \", paymentStatus]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 31\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 9\n  }, this);\n};\n_s(PaymentPage, \"BeavBgQJcnm1purPmL9TP55wYmc=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = PaymentPage;\nexport default PaymentPage;\nvar _c;\n$RefreshReg$(_c, \"PaymentPage\");","map":{"version":3,"names":["Elements","loadStripe","useState","useEffect","useNavigate","useParams","PaymentForm","ApiService","jsxDEV","_jsxDEV","PaymentPage","_s","bookingReference","amount","clientSecret","setClientSecret","error","setError","paymentStatus","setPaymentStatus","navigate","fetchClientSecrete","paymentData","console","log","uniquePaymentSecreet","proceedForPayment","_error$response","_error$response$data","response","data","message","className","children","fileName","_jsxFileName","lineNumber","columnNumber","stripePromise","handlePaymentStatus","transactionId","failureReason","success","updateBookingPaymeent","stripe","options","clientSecrete","onPaymentSuccess","onPaymentError","_c","$RefreshReg$"],"sources":["C:/Users/pc/Downloads/hotel-booking-react/src/component/payment/PaymentPage.jsx"],"sourcesContent":["import { Elements } from \"@stripe/react-stripe-js\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { useState, useEffect } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport PaymentForm from \"./PaymentForm\";\nimport ApiService from \"../../service/ApiService\";\n\n\nconst PaymentPage = () => {\n    const {bookingReference, amount} = useParams()\n    const [clientSecret, setClientSecret] = useState(null)\n    const [error, setError] = useState(null)\n    const [paymentStatus, setPaymentStatus] = useState(null)\n    const navigate = useNavigate();\n\n    useEffect(()=> {\n        const fetchClientSecrete = async () => {\n            try {\n                const paymentData = {bookingReference, amount};\n                console.log(\"BOOKING NO IS: \" + bookingReference)\n                console.log(\"Amount  IS: \" + amount)\n\n                const uniquePaymentSecreet = await ApiService.proceedForPayment(paymentData);\n\n                console.log(\"UNIQUE CLIENT SECRETE FROM fetchClientSecrete is: \" + uniquePaymentSecreet);\n                setClientSecret(uniquePaymentSecreet);\n                \n            } catch (error) {\n                console.log(error)\n                setError(error.response?.data?.message || error.message)\n            }\n        };\n        fetchClientSecrete();\n    }, [bookingReference, amount])\n\n\n\n    if (error) {\n        return <div className=\"error-message\">{error}</div>\n    }\n\n    //initilize strip with public key\n\n    const stripePromise = loadStripe(\n        \"pk_test_51QUUt8HB3OLSUETB41PkCNVZvXQdjyIJx4n7u9EHrMUH0j3R5VAJE76l1fnwQbC3OJlkPwQDIi0KwXGjdU1phB3s00ZJEZOlbv\"\n    );\n\n    //du tion to ipdate payment status for our booking in our backend databse\n    const handlePaymentStatus =  async (paymentStatus, transactionId = \"\", failureReason = \"\") => {\n        try {\n\n            const paymentData = {\n                bookingReference,\n                amount,\n                transactionId,\n                success: paymentStatus === \"succeeded\",\n                failureReason\n            }\n            \n            await ApiService.updateBookingPaymeent(paymentData)\n            console.log(\"Payment sataus weas updated\")\n        } catch (error) {\n            console.log(error.message)\n        }\n    }\n\n    return(\n        <div className=\"payment-page\">\n            <Elements stripe={stripePromise} options={clientSecret}>\n                <PaymentForm\n                clientSecrete={clientSecret}\n                amount={amount}\n                onPaymentSuccess={(transactionId) => {\n                    setPaymentStatus(\"succeeded\")\n                    handlePaymentStatus(\"succeeded\", transactionId)\n                    navigate(`/payment-success/${bookingReference}`)\n                }}\n                onPaymentError={(error) => {\n                    setPaymentStatus(\"failed\");\n                    handlePaymentStatus(\"failed\", \"\", error.message)\n                    navigate(`/payment-failed/${bookingReference}`);\n\n                }}\n                \n                />\n            </Elements>\n\n            {paymentStatus && <div>Payment Status: {paymentStatus}</div>}\n        </div>\n    )\n\n}\n\nexport default PaymentPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}